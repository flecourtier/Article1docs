\input{preamble.tex}

\begin{document}

\begin{tikzpicture}

	\begin{loglogaxis}[
			smaller labels,
			% name
			name = left_plot,
			% axis lines
			axis lines = left,
			enlarge x limits={abs=10pt},
			enlarge y limits={abs=10pt},
			axis x line shift = -5pt,
			axis y line shift = -5pt,
			% labels
			xlabel = {$N$},
			ylabel = {\rotatebox{270}{$L^2$ error on $h$}},
			xlabel style={at={(ticklabel* cs:1.01)},anchor=west},
			ylabel style={at={(ticklabel* cs:1.01)},anchor=west},
			% ticks and labels
			% xmin = 20, xmax = 10240,
			% xtick={20,40,80,160,320,640,1280,2560,5120,10240},
			% xticklabels={$20$,$40$,$80$,$160$,$320$,$640$,$1280$,$2560$,$5120$,$10240$},
			xmin = 40, xmax = 2560,
			xtick={40,160,640,2560},
			xticklabels={$40$,$160$,$640$,$2560$},
			% ymin = 0.1, ymax = 0.85,
			% ytick={0.1,0.2,0.4,0.8},
			% yticklabels={$0.1$,$0.2$,$0.4$,$0.8$},
			% size
			width=\plotwidth, height=\plotheight,
			% marks
			mark options={solid, scale=1},
			% grid
			grid = major,
			% legend
			legend entries={\,HSR1\;, \,HDR1\;, \,HDR2\;, \,HDR3\;,},
			legend columns=4,
			legend to name=leg:legend,
			legend image post style={mark options={solid, scale=1}},
		]

		\printslope{1,2,3}{320}{5e-8}{960}

		\addplot [restrict x to domain=3.6888:7.84776, style={solid}, mark=square*,   mark size=2, line width=0.8pt, color=graph_4            ]
		table [x=N, y=h_HSR_o1_error, col sep=space]
			{SWT_dyadic_hydro_errors.csv};

		\addplot [restrict x to domain=3.6888:7.84776, style={solid}, mark=diamond*,  mark size=2, line width=0.8pt            ]
		table [x=N, y=h_HDR_o1_error, col sep=space]
			{SWT_dyadic_hydro_errors.csv};

		\addplot [restrict x to domain=3.6888:7.84776, style={solid},          mark=*,         mark size=1.5, color=graph_1, line width=0.8pt]
		table [x=N, y=h_HDR_o2theta_error, col sep=space]
			{SWT_dyadic_hydro_errors.csv};

		\addplot [restrict x to domain=3.6888:7.84776, style={solid},          mark=pentagon*, mark size=2, color=graph_2, line width=0.8pt ]
		table [x=N, y=h_HDR_o3theta_error, col sep=space]
			{SWT_dyadic_hydro_errors.csv};

	\end{loglogaxis}

	\begin{loglogaxis}[
			smaller labels,
			% name
			name = right_plot,
			at=(left_plot.outer east), anchor=outer west,
			% axis lines
			axis lines = left,
			enlarge x limits={abs=10pt},
			enlarge y limits={abs=10pt},
			axis x line shift = -5pt,
			axis y line shift = -5pt,
			% labels
			xlabel = {$N$},
			ylabel = {\rotatebox{270}{$L^2$ error on $q$}},
			xlabel style={at={(ticklabel* cs:1.01)},anchor=west},
			ylabel style={at={(ticklabel* cs:1.01)},anchor=west},
			% ticks and labels
			% xmin = 20, xmax = 10240,
			% xtick={20,40,80,160,320,640,1280,2560,5120,10240},
			% xticklabels={$20$,$40$,$80$,$160$,$320$,$640$,$1280$,$2560$,$5120$,$10240$},
			xmin = 40, xmax = 2560,
			xtick={40,160,640,2560},
			xticklabels={$40$,$160$,$640$,$2560$},
			% ymin = 0.1, ymax = 0.85,
			% ytick={0.1,0.2,0.4,0.8},
			% yticklabels={$0.1$,$0.2$,$0.4$,$0.8$},
			% size
			width=\plotwidth, height=\plotheight,
			% marks
			mark options={solid, scale=1},
			% grid
			grid = major,
		]

		\printslope{1,2,3}{320}{15e-8}{960}

		\addplot [restrict x to domain=3.6888:7.84776, style={solid}, mark=square*,   mark size=2, line width=0.8pt, color=graph_4            ]
		table [x=N, y=q_HSR_o1_error, col sep=space]
			{SWT_dyadic_hydro_errors.csv};

		\addplot [restrict x to domain=3.6888:7.84776, style={solid}, mark=diamond*,  mark size=2, line width=0.8pt            ]
		table [x=N, y=q_HDR_o1_error, col sep=space]
			{SWT_dyadic_hydro_errors.csv};

		\addplot [restrict x to domain=3.6888:7.84776, style={solid},          mark=*,         mark size=1.5, color=graph_1, line width=0.8pt]
		table [x=N, y=q_HDR_o2theta_error, col sep=space]
			{SWT_dyadic_hydro_errors.csv};

		\addplot [restrict x to domain=3.6888:7.84776, style={solid},          mark=pentagon*, mark size=2, color=graph_2, line width=0.8pt ]
		table [x=N, y=q_HDR_o3theta_error, col sep=space]
			{SWT_dyadic_hydro_errors.csv};

	\end{loglogaxis}

	\node[yshift=-10pt] at (left_plot.outer south east) {\pgfplotslegendfromname{leg:legend}};

\end{tikzpicture}

\end{document}
